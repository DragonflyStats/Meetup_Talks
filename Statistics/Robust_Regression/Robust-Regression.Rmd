---
title: "Robust Regression - stackloss"
output: html_document
---


### Implementation of Robust Regression

*  When fitting a least squares regression, we might find some outliers or high leverage data points.  We have decided that these data points are not data entry errors, neither they are from a different population than most of our data. So we have no proper reason to exclude them from the analysis.  

*  Robust regression might be a good strategy since it is a compromise between excluding these points entirely from the analysis and including all the data points and treating all them equally in OLS regression. The idea of robust regression is to weigh the observations differently based on how well behaved these observations are.

*  
The idea of robust regression is to weigh the observations differently based on how well behaved these observations are. Roughly speaking, it is a form of weighted and reweighted least squares regression (i.e. a two step process , first fitting a linear model, then a robust model to correct for the influence of outliers).
*  
Robust regression is done by iterated re-weighted least squares (IRLS). The rlm command in the MASS package command implements several versions of robust regression.
*  
There are several weighting functions that can be used for IRLS. We are going to first use the Huber weights in this example. We will then look at the final weights created by the IRLS process. This can be very useful. 
*  
Also we will look at an alternative weighting approach to Huber’s weighting – called \textbf{Bisquare weighting}. 


## Implementation with Bisquare Weighting

Implementing with bisquare weighting simply requires the specification of the additional argument, as per the code below, highlighted in green)

```{r}
FitAll.rr.2 = rlm(taste ~ Acetic + H2S + Lactic,
                  data=cheddar,
                  psi = psi.bisquare)
```
Regression Equation :

taste* = -17.77 -2.26 Acetic + 4.05 H2S + 20.68 Lactic


Weights using Bisquare estimator.

```{r}
hweights2[1:15, ]
```

### Conclusion

*  We can see that the weight given to some observations is dramatically lower using the bisquare weighting function than the Huber weighting function and the coefficient estimates from these two different weighting methods differ. 
*  When comparing the results of a regular OLS regression and a robust regression, if the results are very different, you will most likely want to use the results from the robust regression. 
*  Large differences suggest that the model parameters are being highly influenced by outliers. 
*  Different functions have advantages and drawbacks. Huber weights can have difficulties with severe outliers, and bisquare weights can have difficulties converging or may yield multiple solutions. 

------------------------------------

<pre><code>
> summary(rlm(stack.loss ~ ., stackloss))
Call: rlm(formula = stack.loss ~ ., data = stackloss)
Residuals:
     Min       1Q   Median       3Q      Max 
-8.91753 -1.73127  0.06187  1.54306  6.50163 
Coefficients:
            Value    Std. Error t value 
(Intercept) -41.0265   9.8073    -4.1832
Air.Flow      0.8294   0.1112     7.4597
Water.Temp    0.9261   0.3034     3.0524
Acid.Conc.   -0.1278   0.1289    -0.9922
Residual standard error: 2.441 on 17 degrees of freedom


 rlm(stack.loss ~ ., stackloss, psi = psi.hampel, init = "lts")

> rlm(stack.loss ~ ., stackloss, psi = psi.hampel, init = "lts")
Call:
rlm(formula = stack.loss ~ ., data = stackloss, psi = psi.hampel, 
    init = "lts")
Converged in 10 iterations
Coefficients:
(Intercept)    Air.Flow  Water.Temp  Acid.Conc. 
-40.4748037   0.7410863   1.2250703  -0.1455242 
Degrees of freedom: 21 total; 17 residual
Scale estimate: 3.09 
</code></pre>

%-------------------------------------%
#### Using Other \textit{Psi} Operators

Fitting is done by \textbf{\emph{iterated re-weighted least squares (IWLS).}}
Psi functions are supplied for the Huber, Hampel and Tukey bisquare proposals as psi.huber, \texttt{psi.hampel} and \textbf{psi.bisquare}. 

Huber's corresponds to a convex optimization problem and gives a unique solution (up to collinearity). The other two will have multiple local minima, and a good starting point is desirable.
* huber
* bisquare
* hampel
