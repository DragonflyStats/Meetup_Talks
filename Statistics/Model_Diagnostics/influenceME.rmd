---
title: "Diagnostics for LMEs with R"
author: DragonflyStats.github.io
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### The {influence.ME} R package

The R package {influence.ME} allows you to compute measures of influential data for mixed effects models generated by {lme4}.

#### Tools for detecting influential data in mixed effects models

{influence.ME} provides a collection of tools for detecting influential cases in generalized mixed effects models. It analyses models that were estimated using lme4. 

The basic rationale behind identifying influential data is that when iteratively single units are omitted from the data, models based on these data should not produce substantially different estimates. 

To standardize the assessment of how influential a (single group of) observation(s) is, several measures of influence are common practice, such as DFBETAS and Cook's Distance. 

In addition, we provide a measure of percentage change of the fixed point estimates and a simple procedure to detect changing levels of significance.


### Simple Example

An example model:

```{r message=FALSE,warning=FALSE}
library(lme4)
model <- lmer(mpg ~ disp + (1 | cyl), mtcars)
```

```{r}
summary(model)
```

```{r}
plot(model ,pch=18)
```

The function <tt>influence()</tt> is the basis for all further steps:

```{r message=FALSE,warning=FALSE}
library(influence.ME)
infl <- influence(model, obs = TRUE)
```

Calculate Cook's distance:

```{r message=FALSE,warning=FALSE}

cooks.distance(infl)

```
Plot Cook's distance:
```{r}
plot(infl, which = "cook")
```



* http://journal.r-project.org/archive/2012-2/RJournal_2012-2_Nieuwenhuis~et~al.pdf


